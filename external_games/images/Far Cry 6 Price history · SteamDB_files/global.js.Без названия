"use strict";(function(Y){"use strict";let H=!1,B=!1;const _=[];let q=!1;const D=[],A=[];let x;const i={FollowedApps:new Set,IgnoredApps:new Set,OwnedApps:new Set,FamilySharedApps:new Set,WishedApps:new Set,OwnedPackages:new Set,OnExtensionUserdataLoaded:e=>{if(q){e();return}D.push(e)},EnhanceLazyLoadedApps:e=>{const t=e.querySelectorAll(".app");for(const o of t){const a=+o.dataset.appid;i.FollowedApps.has(a)&&o.classList.add("followed"),i.WishedApps.has(a)&&o.classList.add("wished"),i.OwnedApps.has(a)?o.classList.add("owned"):i.FamilySharedApps.has(a)&&o.classList.add("infamily"),i.IgnoredApps.has(a)&&o.classList.add("ignored")}i.BindHover(e)},EnhanceLazyLoadedPackages:e=>{const t=e.querySelectorAll(".package");for(const o of t){const a=+o.dataset.subid;i.OwnedPackages.has(a)&&o.classList.add("owned")}},BindHover:e=>{},HideHoverIfAny:()=>{},Alert:(e,t=null)=>{const o=document.createElement("toast-notification");return t!==null&&(o.toastTitle=t),o.toastBody=e,document.getElementById("js-notifications")?.append(o),o},Storage:{Get(e){try{return window.localStorage.getItem(e)}catch{return null}},Set(e,t){try{window.localStorage.setItem(e,t)}catch{}},Remove(e){try{window.localStorage.removeItem(e)}catch{}}},LazyLoad(e,t){x||(x=new window.IntersectionObserver(o=>{o.forEach(a=>{a.isIntersecting&&(x.unobserve(a.target),a.target.dispatchEvent(new Event("lazyload")))})},{rootMargin:"200px 0px 200px 0px"})),x.observe(e),e.addEventListener("lazyload",t,{once:!0})},ImageError(e){e.complete&&e.naturalWidth===0?e.src="/static/img/applogo.svg":e.addEventListener("error",function(){this.src="/static/img/applogo.svg"},{once:!0})},RequirePageScreenshotViewer(e,t=!1){if(t===!0){for(let o=0;o<A.length;o++)A[o](e);A.length=0,i.RequirePageScreenshotViewer=o=>o(e)}else A.push(e)},RequireHighstock(e){if(window.Highcharts){z(),e();return}if(_.push(e),H)return;H=!0;const t=document.createElement("script");t.nonce=document.querySelector("script[nonce]").nonce,t.src="/static/js/vendor/highstock.js?v=5ef3248035dbbaa3",t.integrity="sha512-XvMkgDXbuqMG2X2G2Z1d3clYgJ/V5S6zJNn/imYHnv4rrzsHW02lbcmMpLd5Ig2HneoKjTEz6HlQ9qSSVtLdAw==",t.async=!0,t.addEventListener("load",function(){z();for(const o of _)o();_.length=0,H=!1}),document.head.appendChild(t)}},N=e=>{const t=typeof $=="function"&&typeof $.fn=="object"&&typeof $.fn.dataTable=="function";let o=t?[]:document.querySelectorAll(".app"),a=t?[]:document.querySelectorAll(".package");t&&$($.fn.dataTable.tables()).each(function(){const s=$(this).DataTable().table();o=Array.from(s.rows(".app").nodes()),a=Array.from(s.rows(".package").nodes())});const p=[],m=[];for(const s of o){const l=+s.dataset.appid,d=p[l];d?d.push(s):p[l]=[s]}o=null;for(const s of a){const l=+s.dataset.subid,d=m[l];d?d.push(s):m[l]=[s]}if(a=null,e.rgFollowedApps){i.FollowedApps=new Set(e.rgFollowedApps);for(const s of e.rgFollowedApps){const l=p[s];if(l)for(const d of l)d.classList.add("followed")}}if(e.rgWishlist){i.WishedApps=new Set(e.rgWishlist);for(const s of e.rgWishlist){const l=p[s];if(l)for(const d of l)d.classList.add("wished")}}if(e.rgAppsInCart)for(const s of e.rgAppsInCart){const l=p[s];if(l)for(const d of l)d.classList.add("cart")}if(e.rgOwnedApps){i.OwnedApps=new Set(e.rgOwnedApps);for(const s of e.rgOwnedApps){const l=p[s];if(l)for(const d of l)d.classList.add("owned")}}if(e.rgFamilySharedApps){i.FamilySharedApps=new Set(e.rgFamilySharedApps);for(const s of e.rgFamilySharedApps){const l=p[s];if(l)for(const d of l)d.classList.contains("owned")||d.classList.add("infamily")}}if(e.rgIgnoredApps)for(const s of Object.keys(e.rgIgnoredApps)){const l=+s;i.IgnoredApps.add(l);const d=p[l];if(d)for(const g of d)g.classList.add("ignored")}if(e.rgOwnedPackages&&(i.OwnedPackages=new Set(e.rgOwnedPackages)),i.OwnedPackages.add(0),m.length>0){if(e.rgPackagesInCart)for(const s of e.rgPackagesInCart){const l=m[s];if(l)for(const d of l)d.classList.add("cart")}if(e.rgOwnedPackages)for(const s of e.rgOwnedPackages){const l=m[s];if(l)for(const d of l)d.classList.add("owned")}}q=!0;for(const s of D)s();D.length=0},z=()=>{if(B)return;B=!0,window.Highcharts.wrap(window.Highcharts.seriesTypes.flags.prototype,"translate",function(a){if(a.apply(this,...arguments),!this.options.onSeries)return;const p=this.chart.get(this.options.onSeries);!p||!p.points||!p.currentDataGrouping||this.points.forEach(m=>{const s=p.points.find(d=>d.x>m.x);if(!s)return;const l=p.points[s.index>0?s.index-1:0];m.plotX=l.plotX,m.plotY=l.plotY})});const e=!!document.querySelector(".header-user-avatar"),t=1.25,o=e?["copyChartToClipboard","downloadPNG","downloadCSV","downloadXLS"]:["copyChartToClipboard","downloadPNG","steamdbLogin"];window.Highcharts.setOptions({accessibility:{enabled:!1},lang:{locale:"en-GB"},chart:{animation:!1,zooming:{type:"x",mouseWheel:{enabled:!1}},backgroundColor:"transparent",spacing:[5,0,15,0],style:{fontSize:"16px",fontFamily:"inherit"}},title:{style:{color:"var(--body-color)"}},yAxis:{gridLineColor:"rgba(180, 180, 180, 0.2)",labels:{style:{color:"var(--muted-color)"}}},xAxis:{lineColor:"var(--border-color)",tickColor:"var(--border-color)",crosshair:{width:30,color:"rgba(180, 180, 180, 0.2)"},labels:{style:{color:"var(--body-color)"}}},legend:{itemHoverStyle:{color:"var(--link-color)"},itemHiddenStyle:{color:"var(--border-color)"},itemStyle:{color:"var(--body-color)",fontSize:"16px",fontWeight:"400"}},plotOptions:{series:{animation:!1,dataGrouping:{enabled:!1},states:{hover:{lineWidthPlus:0}}}},credits:{text:"data by SteamDB.info (powered by highcharts.com)",position:{x:0,y:-3},style:{fontSize:"12px",color:"var(--muted-color)"}},exporting:{sourceWidth:1200/t,sourceHeight:600/t,scale:t,local:!0,fallbackToExportServer:!1,buttons:{contextButton:{symbol:"url(/static/img/download.svg)",symbolSize:24,symbolX:26,symbolY:25,x:0,y:5,menuItems:o,theme:{fill:"none",states:{hover:{fill:"var(--border-color-2)"},select:{fill:"var(--border-color)"}}}}},menuItemDefinitions:{steamdbLogin:{text:"Login for CSV export"},copyChartToClipboard:{text:"Copy PNG to clipboard",onclick(){const a=this,p="image/png";function m(){return new Promise(s=>{const l=window.Highcharts.Exporting.svgToDataURL(a.exporting.getSVGForExport(a.exporting.options)),d=new Image;d.crossOrigin="anonymous",d.src=l,d.addEventListener("load",()=>{const g=document.createElement("canvas"),C=g.getContext("2d");g.height=d.height*t,g.width=d.width*t,C.drawImage(d,0,0,g.width,g.height),g.toBlob(w=>{s(w)},p)})})}navigator.clipboard.write([new ClipboardItem({[p]:m()})]).then(()=>{const s=i.Alert("The chart png is now in your clipboard.");setTimeout(()=>{s.close()},3e3)}).catch(s=>{console.error(s),i.Alert(`Failed to copy: ${s}`)})}}},chartOptions:{chart:{backgroundColor:"var(--border-color-2)",spacing:[20,20,10,20],style:{fontFamily:"Inter, sans-serif"}},title:{text:"Data by SteamDB",style:{color:"var(--contrast-color)"}},rangeSelector:{enabled:!1},navigator:{enabled:!1},credits:{enabled:!1}}},navigation:{menuStyle:{borderRadius:"6px",borderColor:"var(--border-color)",background:"var(--tooltip-bg)",boxShadow:"-8px -8px 24px rgba(149, 157, 165, 0.2)"},menuItemStyle:{color:"var(--body-bg-color)",transition:"none",fontSize:"14px"}},rangeSelector:{inputEnabled:!1,labelStyle:{color:"var(--body-color)"},buttonTheme:{width:"auto",height:24,paddingLeft:10,paddingRight:10,fill:"none",r:6,stroke:"var(--border-color)","stroke-width":"1px",style:{color:"var(--link-color)",fontSize:"16px",fontWeight:"bold"},states:{hover:{fill:"var(--border-color)",style:{color:"var(--link-color-hover)"}},select:{fill:"var(--border-color)",style:{color:"var(--body-color)"}},disabled:{"stroke-width":0,style:{color:"var(--border-color)"}}}}},navigator:{handles:{backgroundColor:"var(--border-color-2)",borderColor:"var(--link-color)"},xAxis:{gridLineColor:"var(--border-color)",labels:{style:{color:"var(--muted-color)",opacity:1}}},series:{lineWidth:2},outlineColor:"var(--border-color)"},tooltip:{useHTML:!0,shared:!0,split:!1,shadow:!1,borderWidth:0,borderRadius:6,headerFormat:"{ucfirst point.key} UTC<br/>",backgroundColor:"var(--tooltip-bg)",style:{fontSize:"14px",color:"var(--body-bg-color)"}}})},P=(e,t,o)=>{document.querySelectorAll(e).forEach(a=>{o?a.classList.add(t):a.classList.remove(t)})},S=(e,t,o)=>P(`.app[data-appid="${e}"]`,t,o),L=(e,t,o)=>P(`.package[data-subid="${e}"]`,t,o),M=(e,t,o)=>P(`.bundle[data-bundleid="${e}"]`,t,o),R=e=>{if(!(!e.response||!e.response.success)){if(e.request.appid>0){const t=e.request.appid;switch(e.request.contentScriptQuery){case"StoreWishlistAdd":i.WishedApps.add(t),S(t,"wished",!0);break;case"StoreWishlistRemove":i.WishedApps.delete(t),S(t,"wished",!1);break;case"StoreFollow":i.FollowedApps.add(t),S(t,"followed",!0);break;case"StoreUnfollow":i.FollowedApps.delete(t),S(t,"followed",!1);break;case"StoreIgnore":i.IgnoredApps.add(t),S(t,"ignored",!0);break;case"StoreUnignore":i.IgnoredApps.delete(t),S(t,"ignored",!1);break;case"Watch":S(t,"watched",!0);break;case"Unwatch":S(t,"watched",!1);break}}else if(e.request.subid>0){const t=e.request.subid;switch(e.request.contentScriptQuery){case"StoreAddToCart":L(t,"cart",!0);break;case"StoreAddFreeLicense":L(t,"owned",!0);break;case"Watch":L(t,"watched",!0);break;case"Unwatch":L(t,"watched",!1);break}}else if(e.request.bundleid>0){const t=e.request.bundleid;switch(e.request.contentScriptQuery){case"Watch":M(t,"watched",!0);break;case"Unwatch":M(t,"watched",!1);break}}}};if("BroadcastChannel"in window){let e=null;try{e=new BroadcastChannel("steamdb-extension"),e.addEventListener("message",t=>{t&&t.data&&t.data.type==="steamdb:extension-response"&&R(t.data)})}catch{}window.addEventListener("message",t=>{if(!(!t||!t.data)&&t.origin===window.location.origin)if(t.data.type==="steamdb:extension-loaded"){const{data:o}=t.data;document.readyState!=="loading"?N(o):document.addEventListener("readystatechange",()=>{N(o)},{once:!0})}else if(t.data.type==="steamdb:extension-init"){document.querySelectorAll(".js-extension-tip").forEach(a=>{a.hidden=!0}),"OnExtensionInit"in i&&i.OnExtensionInit(t.data.data);try{window.sessionStorage.setItem("extension_user","1")}catch{}}else if(t.data.type==="steamdb:extension-error"){try{if(window.sessionStorage.getItem("extension_error_hidden")&&location.pathname!=="/freepackages/")return}catch{}const o=i.Alert(t.data.error,"Extension error");if(navigator.userAgent.includes(" Firefox/")){const p=document.createElement("a");p.href="https://github.com/SteamDatabase/BrowserExtension/issues/56#issuecomment-2740141287",p.textContent="If you use Firefox containers it is not compatible with it, click to read more.";const m=document.createElement("div");m.classList="toast-body",m.append(p),o.append(m)}const a=document.createElement("a");a.className="btn btn-sm btn-primary",a.href="https://store.steampowered.com/login/",a.textContent="Sign in on the Steam Store",o.append(a),o.addEventListener("toast-close",()=>{try{window.sessionStorage.setItem("extension_error_hidden","1")}catch{}})}else t.data.type==="steamdb:extension-response"&&(e!==null&&e.postMessage(t.data),R(t.data),(!t.data.response||!t.data.response.success)&&!location.pathname.startsWith("/freepackages/")&&(i.Alert(`Something went wrong.
`+(t.data.response&&t.data.response.error||"Unknown error. Are you logged in on the Steam store?"),"Extension error"),console.error(t.data.response)))})}const Q=e=>{const t=[];if(e.forEach((o,a)=>{const p=a.toLowerCase();(p==="__cf_chl_captcha_tk__"||p==="__cf_chl_jschl_tk__"||p==="ref"||p==="fbclid"||p.startsWith("utm_"))&&t.push(a)}),t.length>0){for(const o of t)e.delete(o);window.history.replaceState(null,null,Array.from(e).length?`${location.pathname}?${e}`:location.pathname)}},k=document.querySelector(".header"),b=document.querySelector(".header-menu-container"),E=document.querySelector("#js-header-hamburger");E.addEventListener("click",function(){b.hidden=!b.hidden,b.hidden||(b.querySelector(".header-menu").focus(),k.classList.remove("header-search-focus"),i.HideHoverIfAny())}),b.addEventListener("click",function(e){e.target instanceof Element&&e.target.className===b.className&&(b.hidden=!0)});const O=document.getElementById("js-header-form"),v=O.querySelector(".field");document.addEventListener("keydown",e=>{if(e.key==="Escape"){if(document.documentElement.classList.contains("js-screenshots-shown"))return;b.hidden?k.classList.remove("header-search-focus"):(b.hidden=!0,E.focus())}e.ctrlKey||e.metaKey||!(e.target instanceof Element)||["INPUT","TEXTAREA","SELECT","BUTTON"].includes(e.target.tagName)&&e.target!==E||(e.code==="Slash"||e.code==="KeyS"||e.key==="/"||e.key==="s"?(e.preventDefault(),v.focus()):(e.code==="KeyM"||e.key==="m")&&(e.preventDefault(),E.click()))});function Z(){this.src="/static/p.gif"}if(O){O.addEventListener("submit",function(n){const f=v.value.replace(/^\s+|\s+$/g,"");let c=f.match(/^([0-9]{1,7})$/);if(c!==null){window.location.href=`/app/${c[0]}/${C()}`,n.preventDefault();return}if(c=f.match(/(76561[0-9]{12})/),c!==null){window.location.href=`/calculator/${c[1]}/`,n.preventDefault();return}if(c=f.match(/(?:id|profiles?)\/([\d\w-]+)/),c!==null){window.location.href=`/calculator/?player=${c[1]}`,n.preventDefault();return}c=f.match(/(app|sub|bundle|depot|dlc)\/([0-9]{1,8})/),c!==null&&(c[1]==="dlc"&&(c[1]="app"),window.location.href=`/${c[1]}/${c[2]}/`,n.preventDefault())},!1);const e=document.getElementById("js-search-suggestions"),t=document.getElementById("js-search-tips"),o=new Map;let a=0,p=0,m="",s;const l=t.dataset.a,d=`https://${l}-dsn.algolia.net`,g={Accept:"application/json","x-algolia-application-id":l,"x-algolia-api-key":t.dataset.k},C=()=>{const n=location.pathname.match(/\/app\/[0-9]+\/(?<page>\w+)/);return n?`${n.groups.page}/`:""},w=!0,G=()=>{a=0;let n={hitsPerPage:10,attributesToSnippet:null,attributesToHighlight:["name"],attributesToRetrieve:["objectID","lastUpdated","small_capsule"],responseFields:["hits"],query:m};w&&(n={hitsPerPage:Math.min(20,Math.floor((document.documentElement.clientHeight-130)/55)),attributesToSnippet:null,attributesToHighlight:["name"],attributesToRetrieve:["type","id","small_capsule"],query:m}),s&&s.abort(),s=new AbortController,fetch(`${d}/1/indexes/${w?"all_names":"steamdb"}/query?x-algolia-agent=Algolia%20for%20JavaScript%20(SteamDB)`,{method:"POST",body:JSON.stringify(n),signal:s.signal,headers:g}).then(f=>f.json()).then(f=>{o.set(n.query,f),s=null,U(f)}).catch(console.error)},ee=()=>{a=0;const n={hitsPerPage:20,attributesToSnippet:null,attributesToHighlight:["name"],attributesToRetrieve:["type","id","small_capsule"],query:m};s&&s.abort(),s=new AbortController,fetch(`${d}/1/indexes/all_names/query?x-algolia-agent=SteamDB%20Autocompletion`,{method:"POST",body:JSON.stringify(n),signal:s.signal,headers:g}).then(f=>f.json()).then(f=>{s=null,U(f,!1)}).catch(console.error)},U=(n,f=!0)=>{const c=document.body.dataset.storeAssets;let I=-1;const J=new Set;if(f){const r=e.querySelector(".focus");if(r&&(I=+r.dataset.appid),t.hidden=!0,e.replaceChildren(),i.HideHoverIfAny(),!n.hits){const u=document.createElement("span");n.message?u.innerText=`Algolia error: ${n.message}`:(u.innerText="No results found.",V()),e.appendChild(u);return}}else{if(!n.hits)return;const r=o.get(m);if(r)for(const u of r.hits)J.add(`a${u.objectID}`)}const te=C();let K=0;w&&(n.hits=n.hits.sort((r,u)=>(u.type==="app"?1:0)-(r.type==="app"?1:0)));for(const r of n.hits){if(J.has(r.objectID))continue;const u=document.createElement("a");u.classList.add("app"),w?r.lastUpdated=0:f?(r.type="app",r.id=+r.objectID):(r.lastUpdated=0,u.classList.add("app-small"));let y="/static/img/applogo.svg",T=!0,W=r.type;switch(r.type){case"app":{const h=r.id;u.dataset.appid=h.toString(),u.href=`/app/${h}/${te}`,i.OwnedApps.has(h)?u.classList.add("owned"):i.FamilySharedApps.has(h)?u.classList.add("infamily"):i.WishedApps.has(h)?u.classList.add("wished"):i.FollowedApps.has(h)&&u.classList.add("followed"),I===h&&(I=-1,u.classList.add("focus")),r.small_capsule?y=`${c}apps/${h}/${r.small_capsule}/capsule_231x87.jpg`:y=`${c}apps/${h}/capsule_231x87.jpg?t=${r.lastUpdated}`;break}case"sub":{const h=r.id;u.href=`/sub/${h}/`,i.OwnedPackages.has(h)&&u.classList.add("owned"),r.small_capsule?y=`${c}subs/${h}/${r.small_capsule}`:y=`${c}subs/${h}/capsule_231x87.jpg`;break}case"bundle":{const h=r.id;u.href=`/bundle/${h}/`,r.small_capsule&&(y=`${c}bundles/${h}/${r.small_capsule}/capsule_231x87.jpg`);break}case"developer":case"publisher":case"franchise":{u.href=`/${r.type}/${r.id}/`,y=`${c}${r.small_capsule}`,T=!1;break}case"tag":{u.href=`/tag/${r.id}/`,T=!1,y=null;break}case"tech":{u.href=`/tech/${r.id}/`,W=r.id.substring(0,r.id.indexOf("/")),T=!1,y=null;break}default:continue}if(y){const h=document.createElement("img");h.addEventListener("error",Z,{once:!0}),h.alt="",h.src=y,u.append(h)}const j=document.createElement("span");if(j.className="search-name",j.innerHTML=r._highlightResult.name.value,u.append(j),!f||w&&r.type!=="app"){const h=document.createElement("span");h.className="muted",h.textContent=`${W[0].toUpperCase()}${W.substring(1)}${T?` ${r.id}`:""}`,u.append(h)}if(e.appendChild(u),!w&&++K>10)break}if(f){if(I>-1){const r=e.firstElementChild;r&&r.classList.add("focus")}i.BindHover(e),window.innerHeight>200+K*55&&V()}},V=()=>{w||(clearTimeout(a),p=1/0,a=setTimeout(ee,1e3))};let X=!1;const F=()=>{if(k.classList.add("header-search-focus"),b.hidden=!0,i.HideHoverIfAny(),!X){X=!0;const n=document.createElement("link");n.rel="preconnect",n.href=d,document.head.append(n)}};v.addEventListener("keydown",function(n){if(n.key==="ArrowUp"||n.key==="ArrowDown"){n.preventDefault();const f=e.querySelector(".focus");let c;n.key==="ArrowUp"?(f&&(c=f.previousSibling),c||(c=e.lastElementChild)):(f&&(c=f.nextSibling),c||(c=e.firstElementChild)),c instanceof Element&&(f&&f.classList.remove("focus"),c.classList.add("focus"))}else if(n.key==="Enter"){if(n.ctrlKey){const c=new URLSearchParams;c.append("query",m),window.location.href=`/instantsearch/?${c.toString()}`,n.preventDefault();return}const f=e.querySelector(".focus");f&&(f.click(),n.preventDefault())}else n.key==="Escape"&&v.blur()}),v.addEventListener("input",function(){F();const n=this.value;if(!n||n.length>200){e.replaceChildren(),clearTimeout(a),a=0,s&&s.abort(),m="",t.hidden=!1,i.HideHoverIfAny();return}if(m===n)return;m=n;const f=o.get(m);if(f){clearTimeout(a),a=0,U(f);return}const c=Date.now();if(a){c-p<200&&(clearTimeout(a),p=c,a=setTimeout(G,200));return}p=c,a=setTimeout(G,350)}),document.querySelector(".header-search-close").addEventListener("click",()=>{k.classList.remove("header-search-focus")}),document.querySelector(".header-search-side-close").addEventListener("click",()=>{k.classList.remove("header-search-focus")}),document.querySelector(".header-search-mobile").addEventListener("click",()=>{F(),v.focus()}),v.addEventListener("focus",F)}if(window.location.hostname==="steamdb.info"){const e=new URLSearchParams(location.search);Q(e)}"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).catch(e=>{console.error(e)}),Y.SteamDB=i})(typeof exports<"u"?exports:window);
